
# Clone repository
Clone.
```bash
git clone https://github.com/miketheologitis/FedL-Sync-FDA
```
Materialize LFS files (deep pre-trained models ~2GB).
```bash
git lfs fetch --all
```
```bash
git lfs pull
```
# WorkFlow
1. Using the `create_combinations.py` script, create all the experiments you want to run.
2. Simulate the experiments you created utilizing GPUs, in **SLURM**, in a local machine, or in a server cluster provided they are visible to `nvidia-smi`.

## 1. Combination Script

### Example
Go to project directory `/FedL-Sync-FDA` and create a combinations file:
```bash
python -m fdavg.utils.create_combinations --fda linear sketch --nn DenseNet121 --ds_name CIFAR10 --b 32 --e 100 --th 350 400 --num_clients 5 10 15 20 --comb_file_id 0
```
**Output:**
```
OK! Created 16 combinations in 0.json, i.e., `n_sims` = 16.
```
**Help**:
```shell
python -m fdavg.utils.create_combinations --help
```

## 2. Simulation
Be careful to use the same `--comb_file_id` for both scripts and use the same number of simulations (`--n_sims`) 
as the number of combinations generated by the combinations script.
### Local
**Example**: Go to project directory `/FedL-Sync-FDA` and run the following command:
```bash
python -m local_simulator --n_gpus 2 --n_sims 12 --comb_file_id 0
```
**Help**:
```shell
python -m local_simulator --help
```

### SLURM

**Example**: Go to project directory `/FedL-Sync-FDA` and run the following command:
```shell
python -m slurm_submitter --gpu_mem 5120 --gpus_per_node 2 --sims_per_gpu 2 --mem_per_sim 10240 --cpus_per_sim 2 --nodes_per_submit 2 --n_sims 16 --comb_file_id 0 --walltime 24:00:00
```
**Help**:
```shell
python -m slurm_submitter --help
```
